# History Project

Интерактивная веб-платформа для визуализации исторических событий на карте с интеграцией Telegram-бота.

## Описание

Проект представляет собой веб-приложение, которое позволяет пользователям:
- Просматривать исторические события на интерактивной карте
- Фильтровать события по городам и временным периодам
- Получать информацию о событиях из Wikidata и Wikipedia
- Взаимодействовать с историческими данными через Telegram-бота
- Ежедневно получать событие в Telegram-боте 

## Основные функции

### Веб-приложение
- Интерактивная карта с маркерами исторических событий
- Временная шкала для фильтрации событий по периодам
- Поиск событий по городам
- Детальная информация о каждом событии с ссылками на Wikipedia и Wikidata
- Система авторизации пользователей
- Сохранение пользовательских настроек

### Telegram-бот
- Получение исторических событий по запросу
- Передача событий на веб-платформу через URL-параметры
- Интеграция с Wikidata для получения структурированных данных
- Поддержка поиска событий по городам

## Технологии

### Фронтенд
- HTML5, CSS3, JavaScript (ES6+)
- Leaflet.js (v1.9.4) - библиотека для интерактивных карт
  - OpenStreetMap как основной провайдер карт
  - Кастомные маркеры
- LocalStorage API для хранения пользовательских данных
- Fetch API для асинхронных запросов к Wikipedia и Wikidata
- CSS Grid и Flexbox для адаптивной верстки
- Регулярные выражения для парсинга дат и координат

### Бэкенд
- Python 3.8+
- python-telegram-bot (v20.7) - библиотека для работы с Telegram Bot API
  - Асинхронная обработка команд
  - Система планировщика для ежедневных событий
- SPARQLWrapper (v2.0.0) - библиотека для работы с SPARQL запросами к Wikidata
  - Оптимизированные запросы для получения исторических событий
  - Кэширование результатов запросов
- Wikipedia-API (v0.6.0) - библиотека для работы с Wikipedia API
  - Извлечение текстов и метаданных статей
  - Поиск по категориям и связанным статьям
- asyncio - асинхронное программирование



## Структура проекта

```
History-project/
├── app.js                 # Основной JavaScript файл веб-приложения
├── index.html            # Главная страница
├── styles.css            # Стили приложения
├── tg_bot/              # Директория с кодом Telegram-бота
│   ├── bot.py           # Основной файл бота
│   └── api_utils.py     # Утилиты для работы с API
└── README.md            # Документация проекта
```

## Установка и запуск

### Веб-приложение
1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/History-project.git
```

2. Откройте `index.html` в веб-браузере или используйте локальный сервер:
```bash
python -m http.server 8000
```

3. Откройте `http://localhost:8000` в браузере

### Telegram-бот
1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте файл `.env` с настройками:
```
TELEGRAM_BOT_TOKEN=your_bot_token
```

3. Запустите бота:
```bash
python tg_bot/bot.py
```

## Использование

### Веб-приложение
1. Зарегистрируйтесь или войдите в систему
2. Выберите город для поиска событий
3. Используйте временную шкалу для выбора периода
4. Кликайте на маркеры на карте для просмотра информации о событиях
5. Используйте список событий для быстрой навигации

### Telegram-бот
1. Найдите бота в Telegram по имени @DailyPetersburg
2. Отправьте команду `/start` для начала работы
3. Используйте команду `/event` для получения исторического события
4. Перейдите по ссылке в сообщении бота для просмотра события на карте

## Особенности реализации

### Работа с координатами
- Координаты событий получаются из Wikidata
- Для событий без координат используются координаты города
- Поддержка формата координат Point(lon lat) из Wikidata

### Интеграция с Wikidata
- SPARQL запросы для получения структурированных данных
- Фильтрация событий по городам и датам
- Получение описаний и дополнительной информации

### Интеграция с Wikipedia
- Получение расширенных описаний событий
- Извлечение дат из текста статей
- Кэширование данных для оптимизации запросов

## Ограничения
- Поддерживаются только города, представленные в Wikidata
- Количество событий в результатах поиска ограничено

## Планы по развитию
- Улучшение алгоритмов поиска событий
- Добавление новых источников данных
- Улучшение визуализации на карте

## Авторы

- Ступичев Михаил - бэкенд и фронтэнд разработчик 
